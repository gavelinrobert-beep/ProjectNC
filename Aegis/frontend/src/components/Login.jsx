import React,{useState} from 'react'
import { api } from '../lib/api'
import { setIdToken,setUserRole,getUserRole } from '../lib/auth'
export default function Login({onSuccess}){const [email,setEmail]=useState('admin@aegis.local');const [password,setPassword]=useState('admin123');const [err,setErr]=useState('');async function submit(e){e.preventDefault();setErr('');try{const res=await api.login(email,password);setIdToken(res.access_token);setUserRole(res.role);onSuccess?.(getUserRole())}catch(ex){setErr(String(ex.message||ex))}}return(<div style={{maxWidth:360}}><h3>Logga in</h3>{err&&<div style={{color:'#b5392f',marginBottom:8}}>{err}</div>}<form onSubmit={submit} style={{display:'grid',gap:8}}><input placeholder='E-post' value={email} onChange={e=>setEmail(e.target.value)}/><input placeholder='LÃ¶senord' type='password' value={password} onChange={e=>setPassword(e.target.value)}/><button className='btn' type='submit'>Logga in</button></form><div className='muted' style={{marginTop:8}}>Demo: <code>admin@aegis.local / admin123</code> eller <code>user@aegis.local / user123</code></div></div>)}
